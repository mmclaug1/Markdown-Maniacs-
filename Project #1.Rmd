---
title: 'Project #1'
author: "Kenneth Andrysiak, Joel Revo, Alec Palo, Jacob Cohen, Michael McLaughlan"
date: "2/10/2021"
output: 
  html_document: 
    code_folding: hide
    number_sections: true 
    toc: true
    toc_float: 
      collapsed: true  
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

#Data Import and Basic Sturcture Visualization

```{r}
hotelbookings<-read.csv("hotel_bookings.csv")
hotel<-hotelbookings
library(ggplot2)
```

#Data Cleaning

```{r}
hotel$arrival_date_year<-as.factor(hotel$arrival_date_year)
hotel$arrival_date_month<-as.factor(hotel$arrival_date_month)
hotel$arrival_date_day_of_month<-as.factor(hotel$arrival_date_day_of_month)
hotel$arrival_date_week_number<-as.factor(hotel$arrival_date_week_number)
hotel$is_repeated_guest<-as.factor(hotel$is_repeated_guest)
```

```{r}
hotel$meal<-as.factor(hotel$meal)
hotel$country<-as.factor(hotel$meal)
hotel$market_segment<-as.factor(hotel$market_segment)
hotel$distribution_channel<-as.factor(hotel$distribution_channel)
hotel$reserved_room_type<-as.factor(hotel$reserved_room_type)
hotel$assigned_room_type<-as.factor(hotel$assigned_room_type)
hotel$deposit_type<-as.factor(hotel$deposit_type)
hotel$agent<-as.factor(hotel$agent)
hotel$company<-as.factor(hotel$company)
hotel$customer_type<-as.factor(hotel$customer_type)
hotel$reservation_status<-as.factor(hotel$reservation_status)
hotel$reservation_status_date<-as.factor(hotel$reservation_status_date)
```

## Basic Data Visualization
```{r}
summary(hotel)
str(hotel)
```

Here, we cleaned the data to turn a number of different variables in the data set into factors to make the data easier to work with. 

#Possible Relationships in the Data

A number of different variables in the data seem to have relevant business takeaways. In this section, we will analyze these relationships and provide visualizations of the relationships between the variables.

To begin, we will do some basic descriptive analytics on a number of different variables that we think have some pretty significant business insights.

#How many of the reservations and what proportion of them are being canceled?
```{r}
tableis_canceled<-table(hotel$is_canceled)
round(prop.table(tableis_canceled),3)

```
#How many of each hotel classification (City and Resort) is being canceled?
```{r}
resort<-hotel[hotel$hotel == "Resort",]
city<-hotel[hotel$hotel == "City",]
canceled<-hotel[hotel$is_canceled == "1",]
```
#Which country of origin had the highest cancelation rate?
```{r}

```
#Did the month have any effect on the cancellation within the context of the country of origin?
```{r}

```
#What was the average price paid for reservations that were canceled compared to those that weren't?
```{r}

```
#What was the average price paid by those in resort hotels, and those in city hotels? Did this have any effect on the cancellation rate of each of the classifications?
```{r}

```


#Which booking channel had the most cancellations, and by hotel classification?
```{r}

```
#How many previous cancellations repeated, and by hotel classification?
```{r}

```
#What was the average number of changes made to the bookings in those bookings that were canceled? What about those that weren't, and by hotel classification?
```{r}

```
#Did the deposit type have any effect on the chance of cancelation? By hotel classification?
```{r}

```
#

#How Long are the Groups Staying?
```{r}
weekendnights <- hotel$stays_in_weekend_nights
weekdaynights <- hotel$stays_in_week_nights
totalnights <-weekendnights+weekdaynights

totalnights <- as.factor(totalnights)

plot(totalnights,ylab="Number of Reservations", xlab="Number of Nights Stayed", col="purple")

```
##How big are the groups that are staying?
Here, we are looking to find data related to group size. Since the current data has people grouped into three different columns (adults, children and babies) we will first create a variable to look at the total number of people per group. From this, we will look to compare group size to other vairables. 
```{r}

adults <-hotel$adults
children <-hotel$children
babies <- hotel$babies
groupsize <-adults+children+babies

groupsize <- as.factor(groupsize)

plot(groupsize, xlim=c(1,6),ylab="Number of Reservations", xlab="People in Reservation", col="purple")


meanadrbygroup <- round(tapply(hotel$adr,groupsize, mean, na.rm=TRUE), 3)

meanadrbygroup


ggplot(hotel, aes(x=groupsize, y=adr))+ geom_bar(stat = "identity")
 ##Not sure what graph to do here but theres something here

```

```{r}
library(ggplot2)

ggplot(hotel, aes(x=groupsize, fill=market_segment)) + geom_bar(position = "stack")

ggplot(hotel, aes(x=groupsize, fill=country)) + geom_bar(position = "stack")

ggplot(hotel, aes(x=adr, fill=groupsize)) + geom_density(alpha=0.4) + labs(title="Lead Time by Group Size") # This is obviously a bad graph just trying some things out

```
## Do Kids cause more special requests?
Here, we will look to see if number of children + babies is related to the number of special requests. 
```{r}

mean(hotel$total_of_special_requests, na.rm=TRUE)

nonadults<-children+babies

#Basically what im looking to do here is find out whether children and babies increase number of speical requests. Any ideas?


```


##Average Price Per Person 
```{r}
priceperperson<-hotel$adr*groupsize


```


#Summary

# Jacob's test

```{r}
summary(hotel$groupsize)
# Are you seeing this?
```

