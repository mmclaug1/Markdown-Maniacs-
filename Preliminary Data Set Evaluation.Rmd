---
title: "Project 3 - Early"
author: "Joel Revo, Kenny Andrysiak, Jacob Cohen, Alec Palo, Michael McLaughlan"
date: "3/29/2021"
output: 
  html_document: 
    code_folding: hide
    number_sections: true 
    toc: true
    toc_float: 
      collapsed: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r include = FALSE}
library(VGAM)
library(class)
library(caret)
library(gmodels)
library(tidyverse)
library(lmtest)
library(aod)
library(neuralnet)
library(C50)
```
# Abstract and Guiding Question 

Data Set 
(Assumption) We are assuming that the dataset is taken from many different passengers from different airlines. However, we do not have data on each individual airline. So our audience will be the Airline industry as a whole. We will tailor our results to different airline categories (Luxury, standard, budget). 

Guiding Question 

1. We want to predict whether or not a given customer will be satisfied or not

2. What parts of the customer experience contribute most to whether a customer is satisfied or not, and how would different airlines best implement their services to make a customer satisfied? 


# Data Cleaning 
```{r}

Airlinedata<-read.csv("Invistico_Airline.csv")

# Making Variables Factors that are Binary
Airlinedata$Gender<-as.factor(Airlinedata$Gender)
Airlinedata$Customer.Type<-as.factor(Airlinedata$Gender)
Airlinedata$Type.of.Travel<-as.factor(Airlinedata$Type.of.Travel)
Airlinedata$Class<-as.factor(Airlinedata$Class)


# Converting Response Variable to a Binary Variable
Airlinedata$satisfaction<-ifelse(Airlinedata$satisfaction=="satisfied", 1, 0)

Airlinedata <- na.omit(Airlinedata)

str(Airlinedata)
```

# Normalize The Data
```{r}
# Creating Dummy Variables to make everything numeric
Airlinemm <- as.data.frame(model.matrix(~.-1,Airlinedata))

# Randomizing the data (shuffling the rows)
set.seed(12345)
airline_random <- Airlinemm[sample(nrow(Airlinemm)),]

#Normalize the data to keep everything on the same scale
normalize <- function(x){return ((x - min(x)) / (max(x) - min(x)))}

airline_norm <- as.data.frame(lapply(airline_random, normalize))
```

## Get Training and Testing Samples

```{r}
airline_train <- airline_norm[1:105000,]
airline_test <- airline_norm[105001:129487,]


airline_train_labels <- airline_norm[1:105000, "satisfaction"]
airline_test_labels <- airline_norm[105001:129487, "satisfaction"]
```

# Logistic Model 

```{r}
airline_glm <- glm(satisfaction ~ ., data = airline_train, family= "binomial")
```


```{r cach = TRUE, include = FALSE}
step_airline<-step(airline_glm)
```

## Step Model Summary

```{r}
summary(step_airline)
```

## Logistic Model Predictions 

```{r}
AirlineGLM_pred <- ifelse(predict(step_airline, newdata =airline_test,  type = "response") >= .33, 1, 0)

confusionMatrix(as.factor(AirlineGLM_pred), as.factor(airline_test$satisfaction), positive = "1")
```

## Logistic Model Interpretations 

```{r}

```

# ANN Model

```{r cache=TRUE}
airline_neural<-neuralnet(satisfaction ~., data = airline_train)
``` 

## ANN Model Predictions 

```{r}
neural_results<-compute(airline_neural, airline_test[1:ncol(airline_test)])

ANN_predicted<-ifelse(neural_results$net.result>=0.33,1,0)

cor(ANN_predicted, airline_test$satisfaction)

confusionMatrix(data = as.factor(ANN_predicted), reference = as.factor(airline_test_labels), positive = "1")
```

## ANN Model Interpretation 

```{r}

```

#KNN Model

```{r cache=TRUE}

airline_train_KNN <- airline_train
airline_test_KNN <-airline_test

airline_train_KNN$satisfaction<-NULL
airline_test_KNN$satisfaction<-NULL

sqrt(nrow(airline_train_KNN))

airline_KNN <- knn(train = airline_train_KNN, test = airline_test_KNN, cl = airline_train_labels, k=325)

confusionMatrix(as.factor(airline_KNN), as.factor(airline_test_labels), positive = "1")

```

## KNN Model Interpretaion 

```{r}

```

# Tree Model 

```{r cache=TRUE}
Airline_Tree<-C5.0(as.factor(satisfaction) ~., data = airline_train)

Airline_tree_pred<-predict(Airline_Tree, airline_train)
```

## Tree Model Predictions 

```{r}
airline_tree_pred<-predict(Airline_Tree, airline_test)

confusionMatrix(data = as.factor(airline_tree_pred), reference = as.factor(airline_test_labels), positive = "1")
```

## Tree Model Interpretation 

```{r}

```

# Combined Model
```{r}
combine_model_pred<-ifelse(as.integer(AirlineGLM_pred)+(as.integer(airline_KNN)-1)+as.integer(ANN_predicted) + (as.integer(airline_tree_pred)-1)>=2,1,0)

cor(combine_model_pred,airline_test$satisfaction)

confusionMatrix(as.factor(combine_model_pred), as.factor(airline_test$satisfaction))
```

## Conclusions